/* ============================
   Mossy Metro • Deluxe Styles
   ============================ */

/* ----- Theme tokens ----- */
:root{
  --bg-0: #0b0f16;         /* page background */
  --bg-1: #0f1520;         /* canvas backdrop */
  --bg-2: #121a29;         /* glass panels */
  --ink-0:#e8f0ff;         /* primary text */
  --ink-1:#b9c6dc;         /* secondary text */
  --accent:#70f0a1;        /* neon green */
  --accent-2:#8cc7ff;      /* sky blue */
  --danger:#ff6b6b;        /* alerts / damage */
  --shadow-1: 0 10px 30px rgba(0,0,0,.35);
  --shadow-2: 0 6px 18px rgba(0,0,0,.25);
  --glass: rgba(20,28,44,.6);
  --br: 16px;              /* panel radius */
  --pad: 12px;             /* base padding */
}

/* Smooth motion but respect accessibility */
@media (prefers-reduced-motion: no-preference){
  :root{
    --t-fast: .12s cubic-bezier(.2,.8,.2,1);
    --t-slow: .35s cubic-bezier(.2,.8,.2,1);
  }
}
@media (prefers-reduced-motion: reduce){
  :root{ --t-fast: 0s; --t-slow: 0s; }
}

*{box-sizing:border-box}

/* Page */
html,body{
  height:100%;
  margin:0;
  background:
    radial-gradient(1200px 700px at 50% -10%, #152034, #0b0f16 65%),
    linear-gradient(180deg, #0c1220 0%, #0b0f16 100%);
  color:var(--ink-0);
  font-family: ui-sans-serif, system-ui, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  -webkit-tap-highlight-color: transparent;
}

/* Game wrap keeps everything neatly contained */
#game-wrap{
  position:relative;
  inline-size:min(1120px, 100vw);
  block-size:100svh;
  margin-inline:auto;
  display:grid;
  grid-template-rows: 1fr;
  padding: clamp(6px, 1.2vmin, 10px);
}

/* Canvas with subtle “bezel” */
#game{
  display:block;
  inline-size:100%;
  block-size:100%;
  background:
    radial-gradient(1800px 1200px at 50% -20%, #122035 0%, #0f1523 55%, #0b0f16 86%),
    linear-gradient(#0e1726 0 45%, #0f1a2f 45% 70%, #0b0f16 70%);
  border-radius: calc(var(--br) + 4px);
  box-shadow:
    0 0 0 1px rgba(140,199,255,.08) inset,
    var(--shadow-1);
  outline:none;
}

/* ===== HUD ===== */

#hud{
  position:absolute;
  inset-inline: clamp(10px, 2vw, 18px);
  inset-block-start: clamp(10px, 1.6vh, 18px);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
  z-index:10;
  padding: 10px 12px;
  border-radius: var(--br);
  background: linear-gradient(180deg, rgba(18,26,41,.78), rgba(16,24,37,.54));
  border: 1px solid rgba(140,199,255,.16);
  backdrop-filter: blur(8px) saturate(120%);
  box-shadow: var(--shadow-2);
  pointer-events:none; /* clicks pass through */
}

#hud .hud-left, #hud .hud-right{
  display:flex; align-items:center; gap:12px;
  pointer-events:auto;
}

#levelName{
  font-weight:700;
  letter-spacing:.2px;
  color:var(--ink-0);
  text-shadow: 0 2px 10px rgba(128, 226, 255, .18);
}

/* badge chips */
#hud .hud-right span{
  padding:6px 10px;
  border-radius: 999px;
  font-weight:600;
  font-size:.95rem;
  background: linear-gradient(180deg, rgba(20,28,44,.85), rgba(16,24,36,.6));
  border:1px solid rgba(140,199,255,.18);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
}
#hearts{ color: var(--danger); }
#coins{ color: var(--accent-2); }
#heldItem{ color: var(--accent); }

/* ===== On-screen Controls ===== */

#controls{
  position:absolute;
  inset-inline: clamp(8px, 2vw, 18px);
  inset-block-end: clamp(8px, 2vh, 18px);
  display:flex;
  justify-content:space-between;
  align-items:end;
  gap: clamp(10px, 2vw, 18px);
  z-index:20;
  pointer-events:none;
}

/* Joystick container */
#stick{
  position:relative;
  inline-size: clamp(140px, 26vw, 190px);
  block-size: clamp(140px, 26vw, 190px);
  pointer-events:auto;
  touch-action:none;
}

/* Glassy base ring */
#stick-base{
  position:absolute; inset:0;
  border-radius:50%;
  background: radial-gradient(60% 60% at 35% 35%, rgba(49,66,96,.7), rgba(22,32,50,.7) 70%);
  border:1px solid rgba(140,199,255,.22);
  box-shadow: var(--shadow-2), inset 0 6px 24px rgba(0,0,0,.35);
  backdrop-filter: blur(6px) saturate(120%);
}

/* Knob with neon ring */
#stick-knob{
  --size: clamp(62px, 11.5vw, 86px);
  position:absolute;
  inline-size:var(--size);
  block-size:var(--size);
  border-radius:50%;
  background:
    radial-gradient(70% 70% at 30% 30%, #3d5672, #213245 70%);
  border:1px solid rgba(140,199,255,.28);
  box-shadow:
    0 0 0 2px rgba(112,240,161,.08),
    0 10px 20px rgba(0,0,0,.35);
  inset-inline-start:calc(50% - var(--size)/2);
  inset-block-start:calc(50% - var(--size)/2);
  transition: transform var(--t-fast);
}

/* Action button grid */
#buttons{
  display:grid;
  grid-template-columns:repeat(2, clamp(64px, 14vw, 90px));
  grid-template-rows:repeat(2, clamp(64px, 14vw, 90px));
  gap: clamp(8px, 1.6vw, 12px);
  pointer-events:auto;
}

/* Button look: soft neon glass */
.btn{
  inline-size:100%;
  block-size:100%;
  border-radius: 20px;
  background:
    linear-gradient(180deg, rgba(32,48,73,.95), rgba(22,33,50,.9)),
    radial-gradient(120% 120% at 50% 0%, rgba(255,255,255,.06), rgba(255,255,255,0) 60%);
  color:var(--ink-0);
  font-size: clamp(22px, 4.2vw, 28px);
  border:1px solid rgba(140,199,255,.22);
  box-shadow:
    0 0 0 2px rgba(140,199,255,.06) inset,
    0 8px 20px rgba(0,0,0,.35);
  touch-action:manipulation;
  transition: transform var(--t-fast), box-shadow var(--t-fast), filter var(--t-fast);
}
.btn:hover{ filter:brightness(1.06); }
.btn:active { transform: translateY(2px) scale(.98); }

/* Give jump its own color hint */
.btn-jump{
  background:
    linear-gradient(180deg, rgba(40,92,65,.95), rgba(26,54,39,.92)),
    radial-gradient(120% 120% at 50% 0%, rgba(255,255,255,.06), rgba(255,255,255,0) 60%);
  border-color: rgba(112,240,161,.28);
  box-shadow:
    0 0 0 2px rgba(112,240,161,.08) inset,
    0 10px 24px rgba(16,40,28,.6);
  grid-column:2; grid-row:1;
}

/* ===== Help / Controls drawer ===== */

#help{
  position:absolute;
  inset-inline: clamp(8px, 2vw, 18px);
  inset-block-end: clamp(8px, 2vh, 18px);
  z-index:25;
  background: var(--glass);
  border:1px solid rgba(140,199,255,.16);
  border-radius: 14px;
  box-shadow: var(--shadow-2);
  padding: 8px 12px;
  max-inline-size:min(620px, 94vw);
  color:var(--ink-1);
  backdrop-filter: blur(8px) saturate(120%);
}

#help summary{
  cursor:pointer;
  color: var(--accent-2);
  font-weight: 700;
  list-style:none;
}
#help summary::-webkit-details-marker{ display:none; }
#help .help-body{ margin-block-start: 6px; }

/* ===== Micro polish for small screens ===== */

@media (max-width: 480px){
  #hud{
    gap:8px;
    padding:8px 10px;
  }
  #levelName{ font-size:.95rem; }
  #hud .hud-right span{ font-size:.9rem; padding:5px 8px; }
}

/* Hide control chrome slightly on desktops with mouse */
@media (hover:hover) and (pointer:fine){
  #controls{ opacity:.9; }
  #help{ opacity:.95; }
}

/* Respect notches / safe areas */
@supports (padding: max(env(safe-area-inset-bottom), 0px)) {
  #game-wrap{ padding: max(6px, env(safe-area-inset-top)) max(6px, env(safe-area-inset-right)) max(6px, env(safe-area-inset-bottom)) max(6px, env(safe-area-inset-left)); }
  #controls{ inset-block-end: max(8px, calc(env(safe-area-inset-bottom) + 8px)); }
  #help{ inset-block-end: max(8px, calc(env(safe-area-inset-bottom) + 8px)); }
}

/* ===== Optional: subtle breathing glow around canvas ===== */
@media (prefers-reduced-motion: no-preference){
  #game{
    animation: bezelGlow 6s ease-in-out infinite;
  }
  @keyframes bezelGlow{
    0%,100%{ box-shadow:
      0 0 0 1px rgba(140,199,255,.08) inset,
      0 20px 40px rgba(0,0,0,.38),
      0 0 60px rgba(112,240,161,.0); }
    50%{ box-shadow:
      0 0 0 1px rgba(140,199,255,.10) inset,
      0 26px 60px rgba(0,0,0,.42),
      0 0 80px rgba(112,240,161,.06); }
  }
}