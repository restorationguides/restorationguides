<!doctype html>

<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Starlight FB MP4 — Bring‑Your‑Own‑Backend</title>
<style>
  :root{
    --bg1:#0f1226; /* deep indigo */
    --bg2:#0a0c1b; /* space blue */
    --accent:#7cffe1; /* mint neon */
    --accent-2:#a08bff; /* lavender neon */
    --glass: rgba(255,255,255,.08);
    --text:#e8ecf3;
    --muted:#a3acc0;
    --danger:#ff6b6b;
    --ok:#00d17a;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    color:var(--text);
    font: 16px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
    background: radial-gradient(1200px 800px at 20% 10%, #1a2048 0%, transparent 60%),
                radial-gradient(1000px 600px at 80% 0%, #1c2b5c 0%, transparent 55%),
                linear-gradient(180deg, var(--bg1), var(--bg2));
    overflow: hidden;
  }
  /* Animated floating blobs */
  .blob{position:fixed; filter: blur(40px); opacity:.5; mix-blend-mode:screen; pointer-events:none}
  .blob.b1{width:40vmax;height:40vmax;left:-10vmax;top:-10vmax;background:conic-gradient(from 0deg, #6fffd2, #9fa8ff, #6fffd2);animation: drift 26s linear infinite}
  .blob.b2{width:35vmax;height:35vmax;right:-10vmax;top:10vmax;background:conic-gradient(from 120deg, #9fa8ff, #6fffd2, #9fa8ff);animation: drift 34s linear reverse infinite}
  @keyframes drift{0%{transform:rotate(0deg) translateY(0)} 50%{transform:rotate(180deg) translateY(3vmax)} 100%{transform:rotate(360deg) translateY(0)}}.wrap{position:relative; height:100%; display:grid; place-items:center; padding:24px}

.card{ width:min(900px, 95vw); border-radius:24px; background:linear-gradient( to bottom right, rgba(255,255,255,.12), rgba(255,255,255,.04)); box-shadow: 0 20px 60px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.12); backdrop-filter: blur(20px) saturate(120%); padding: clamp(18px, 3vw, 28px); }

header{ display:flex;align-items:center;gap:14px;margin-bottom:18px } .logo{ width:40px;height:40px;border-radius:12px;display:grid;place-items:center; background:radial-gradient(120% 120% at 20% 20%, var(--accent) 0%, var(--accent-2) 45%, transparent 55%), linear-gradient(145deg, rgba(255,255,255,.18), rgba(255,255,255,.02)); box-shadow: inset 0 0 0 1px rgba(255,255,255,.2), 0 10px 30px rgba(124,255,225,.25); } .logo svg{width:22px;height:22px} h1{font-size: clamp(20px, 3.4vw, 32px);margin:0;letter-spacing:.4px} .sub{color:var(--muted);font-size:clamp(13px,1.6vw,15px)}

.row{display:flex;gap:12px;flex-wrap:wrap} .urlbox{position:relative; flex:1 1 540px;} input[type="url"]{ width:100%; padding:16px 52px 16px 52px; border-radius:14px;border:1px solid rgba(255,255,255,.18); background: rgba(0,0,0,.25); color:var(--text); outline:none; backdrop-filter: blur(8px); transition: border .15s, box-shadow .15s; } input[type="url"]:focus{border-color:var(--accent);box-shadow:0 0 0 6px rgba(124,255,225,.12)} .urlbox .yicon{position:absolute; left:12px; top:50%; transform:translateY(-50%); opacity:.85} .urlbox .clear{position:absolute; right:12px; top:50%; transform:translateY(-50%); opacity:.7; cursor:pointer; border-radius:8px; padding:6px} .urlbox .clear:hover{background:rgba(255,255,255,.08)}

.actions{display:flex; gap:10px; align-items:center} .btn{ appearance:none; border:0; cursor:pointer; border-radius:14px; padding:14px 18px; font-weight:700; letter-spacing:.3px; color:#071217; background:linear-gradient(135deg, var(--accent), var(--accent-2)); box-shadow: 0 10px 30px rgba(124,255,225,.25), 0 8px 20px rgba(160,139,255,.2); transition: transform .06s ease, filter .2s ease; } .btn:active{transform:translateY(1px) scale(.99)} .btn.secondary{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.18)}

.panel{ margin-top:16px; display:grid; grid-template-columns: 220px 1fr; gap:16px; align-items:start } @media (max-width:820px){.panel{grid-template-columns: 1fr}}

.preview{ border-radius:16px; overflow:hidden; background:rgba(255,255,255,.06); position:relative; box-shadow: inset 0 0 0 1px rgba(255,255,255,.12); } .thumb{aspect-ratio:16/9; width:100%; display:block; object-fit:cover; background:#05060f} .vidmeta{padding:12px 14px; display:flex; gap:10px; align-items:center} .dot{width:8px;height:8px;border-radius:50%;background:var(--ok);box-shadow:0 0 12px var(--ok)} .title{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}

.status{ background:rgba(255,255,255,.06); border-radius:16px; padding:14px; min-height:72px; box-shadow: inset 0 0 0 1px rgba(255,255,255,.12); } .status h3{margin:0 0 6px 0; font-size:15px; color:var(--muted)} .progress{ height:10px; border-radius:999px; background:rgba(255,255,255,.08); overflow:hidden; position:relative } .progress > i{display:block; height:100%; width:0%; background:linear-gradient(90deg, var(--accent), var(--accent-2)); transition:width .25s ease} .hint{font-size:13px;color:var(--muted); margin-top:8px}

.toolbar{display:flex; gap:10px; flex-wrap:wrap} .pill{padding:8px 12px; border-radius:999px; border:1px solid rgba(255,255,255,.16); background:rgba(0,0,0,.2); font-size:13px} .pill label{opacity:.8; margin-right:6px}

/* Settings modal */ dialog{ border: 1px solid rgba(255,255,255,.2); border-radius:16px; padding:0; background:rgba(28,30,58,.9); color:var(--text); width:min(560px,92vw); backdrop-filter: blur(12px)} dialog::backdrop{ background: rgba(0,0,0,.4) } .modal-head{display:flex; align-items:center; justify-content:space-between; padding:14px 16px; border-bottom:1px solid rgba(255,255,255,.12)} .modal-body{padding:16px} .modal-actions{display:flex; gap:8px; justify-content:flex-end; padding:12px 16px; border-top:1px solid rgba(255,255,255,.12)}

.toast{position:fixed; bottom:18px; left:50%; transform:translateX(-50%) translateY(30px); opacity:0; transition: all .25s ease; background:rgba(0,0,0,.6); border:1px solid rgba(255,255,255,.14); padding:10px 14px; border-radius:12px} .toast.show{opacity:1; transform:translateX(-50%) translateY(0)}

/* Tiny helper icons */ .icon{width:22px;height:22px;opacity:.9} .gear{width:38px;height:38px; display:grid; place-items:center; border-radius:12px; border:1px solid rgba(255,255,255,.18); background:rgba(255,255,255,.06); cursor:pointer} .gear:hover{filter:brightness(1.1)}

footer{margin-top:14px; font-size:12px; color:var(--muted)} footer a{color:var(--accent)} </style>

</head>
<body>
  <div class="blob b1"></div>
  <div class="blob b2"></div>
  <div class="wrap">
    <div class="card" role="application" aria-label="Starlight MP4 video fetcher">
      <header>
        <div class="logo" aria-hidden="true">
          <!-- FB icon -->
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <rect width="24" height="24" rx="6" fill="#1877F2"/>
            <path d="M14.5 8.5h-1.7c-.3 0-.8.2-.8.9v1.1h2.4l-.3 2.2h-2.1V20h-2.3v-7.3H6.9v-2.2h2.8V9.6c0-2.2 1.3-3.6 3.4-3.6 1 0 1.6.1 2.3.2l-.9 2.3z" fill="#fff"/>
          </svg>
        </div>
        <div style="flex:1 1 auto">
          <h1>Starlight FB MP4</h1>
          <div class="sub">Gorgeous front‑end UI to request MP4 conversions from a backend <em>you control<\/em> for Facebook videos you have rights to. ✨</div>
        </div>
        <button class="gear" id="openSettings" title="Settings (set your API URL)">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c0 .66.39 1.26 1 1.51.16.07.33.11.51.11H21a2 2 0 1 1 0 4h-.09c-.18 0-.35.04-.51.11-.61.25-1 .85-1 1.51z"/></svg>
        </button>
      </header><div class="row" role="group" aria-label="Paste video URL and choose options">
    <div class="urlbox">
      <svg class="yicon" viewBox="0 0 24 24" width="24" height="24" aria-hidden="true"><rect width="24" height="24" rx="6" fill="#1877F2"/><path d="M14.5 8.5h-1.7c-.3 0-.8.2-.8.9v1.1h2.4l-.3 2.2h-2.1V20h-2.3v-7.3H6.9v-2.2h2.8V9.6c0-2.2 1.3-3.6 3.4-3.6 1 0 1.6.1 2.3.2l-.9 2.3z" fill="#fff"/></svg>
      <input id="url" type="url" placeholder="Paste Facebook video URL (e.g., https://www.facebook.com/watch/?v=1234567890 or https://fb.watch/abc123/)" autocomplete="off" spellcheck="false" inputmode="url" />
      <div class="clear" title="Clear" id="clearUrl">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </div>
    </div>
    <div class="actions">
      <button class="btn" id="downloadBtn">Request MP4</button>
      <button class="btn secondary" id="previewBtn">Preview</button>
    </div>
  </div>

  <div class="panel">
    <section class="preview" aria-live="polite" aria-atomic="true">
      <img id="thumb" class="thumb" alt="Video thumbnail preview" src="" />
      <div class="vidmeta">
        <span class="dot" id="statusDot" title="Status"></span>
        <div style="min-width:0">
          <div class="title" id="vidTitle">No video selected yet.</div>
          <div class="sub" id="vidSub">Paste a URL and click Preview. We'll pull the thumbnail and basic info client‑side.</div>
        </div>
      </div>
    </section>
    <section>
      <div class="toolbar" style="margin-bottom:10px">
        <span class="pill"><label>Format</label><strong>MP4</strong></span>
        <span class="pill"><label>Quality</label>
          <select id="quality" style="background:transparent;color:var(--text);border:0;outline:none">
            <option value="best">Best Available</option>
            <option value="1080p">1080p</option>
            <option value="720p">720p</option>
            <option value="480p">480p</option>
          </select>
        </span>
        <span class="pill"><label>Audio</label>
          <select id="audio" style="background:transparent;color:var(--text);border:0;outline:none">
            <option value="with">Include</option>
            <option value="mute">Mute</option>
          </select>
        </span>
      </div>
      <div class="status">
        <h3>Status</h3>
        <div class="progress" aria-label="Progress"><i id="bar"></i></div>
        <div class="hint" id="hint">Waiting for URL. Note: This page is a front‑end only. To actually convert, point it at your own server (e.g., a self‑hosted API that uses yt‑dlp with proper cookies/tokens) and only download when you have rights to do so.</div>
      </div>
      <footer>
        ⚖️ <strong>Respect platform terms & creators.</strong> Use only for content you own or that is licensed for download (e.g., your uploads, CC‑licensed media). This UI does not bypass DRM and ships without any downloader code.
      </footer>
    </section>
  </div>
</div>

  </div>  <dialog id="settings">
    <div class="modal-head">
      <strong>Settings</strong>
      <button class="gear" id="closeSettings" aria-label="Close settings">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </div>
    <div class="modal-body">
      <label for="apiUrl">Downloader API URL</label>
      <input id="apiUrl" type="url" placeholder="https://your-server.example.com/api/convert" style="width:100%;margin-top:8px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.2);background:rgba(0,0,0,.3);color:var(--text)"/>
      <p class="sub" style="margin-top:10px">This should be a server you control that accepts <code>POST { url, format, quality, audio }</code> and streams or returns a file link.</p>
    </div>
    <div class="modal-actions">
      <button class="btn secondary" id="saveSettings">Save</button>
    </div>
  </dialog>  <div id="toast" class="toast" role="status" aria-live="polite">Saved.</div><script>
  const $ = sel => document.querySelector(sel);
  const urlInput = $('#url');
  const thumb = $('#thumb');
  const titleEl = $('#vidTitle');
  const subEl = $('#vidSub');
  const bar = $('#bar');
  const hint = $('#hint');
  const dot = $('#statusDot');
  const settings = $('#settings');
  const apiUrlInput = $('#apiUrl');
  const toast = $('#toast');

  // Restore API URL from localStorage
  apiUrlInput.value = localStorage.getItem('starlight_api') || '';

  function toastMsg(msg){
    toast.textContent = msg; toast.classList.add('show');
    setTimeout(()=> toast.classList.remove('show'), 2200);
  }

  function getFacebookId(u){
    try{
      const url = new URL(u);
      const host = url.hostname.replace('www.','');
      if(/^(facebook\.com|fb\.watch)$/i.test(host)){
        if(host === 'fb.watch'){
          // fb.watch short codes (not numeric IDs). Return code for display
          return { type:'shortcode', id: url.pathname.replace(/\//g,'') };
        }
        // facebook.com patterns
        const v = url.searchParams.get('v');
        if(v) return { type:'video', id: v };
        const parts = url.pathname.split('/').filter(Boolean);
        // /reel/{id}
        const reelIx = parts.indexOf('reel');
        if(reelIx !== -1 && parts[reelIx+1]) return { type:'reel', id: parts[reelIx+1] };
        // /videos/{id}
        const vidIx = parts.indexOf('videos');
        if(vidIx !== -1 && parts[vidIx+1]) return { type:'video', id: parts[vidIx+1] };
      }
    }catch{ /* ignore */ }
    return null;
  }

  function updatePreview(){
    const u = urlInput.value.trim();
    const info = getFacebookId(u);
    if(!u){
      thumb.removeAttribute('src'); thumb.style.background='linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.02))';
      titleEl.textContent='No video selected yet.'; subEl.textContent='Paste a URL and click Preview.'; return;
    }
    if(!info){
      thumb.removeAttribute('src'); thumb.style.background='linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.02))';
      titleEl.textContent='Unsupported or invalid URL'; subEl.textContent='This UI is optimized for Facebook links.'; return;
    }
    // We cannot fetch FB thumbnails client‑side without tokens due to CORS/Graph permissions.
    thumb.removeAttribute('src');
    thumb.style.background='center / 42px 42px no-repeat #05060f url(\"data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 24 24\'%3E%3Crect width=\'24\' height=\'24\' rx=\'6\' fill=\'%231877F2\'/%3E%3Cpath d=\'M14.5 8.5h-1.7c-.3 0-.8.2-.8.9v1.1h2.4l-.3 2.2h-2.1V20h-2.3v-7.3H6.9v-2.2h2.8V9.6c0-2.2 1.3-3.6 3.4-3.6 1 0 1.6.1 2.3.2l-.9 2.3z\' fill=\'%23fff\'/%3E%3C/svg%3E\")';
    titleEl.textContent = info.type.toUpperCase() + ' ID: ' + info.id;
    subEl.textContent = 'Thumbnail requires backend fetch via Graph API. Preview limited client‑side for privacy/CORS.';
    dot.style.background = 'var(--ok)'; dot.style.boxShadow = '0 0 12px var(--ok)';
  }

  
    const u = urlInput.value.trim();
    const id = getYouTubeId(u);
    if(!u){
      thumb.src=''; titleEl.textContent='No video selected yet.'; subEl.textContent='Paste a URL and click Preview.'; return;
    }
    if(!id){
      thumb.src=''; titleEl.textContent='Unsupported or invalid URL'; subEl.textContent='This UI is optimized for Facebook links.'; return;
    }
    // Use standard YouTube thumbnail endpoint (client-side, no CORS required)
    const t = `https://img.youtube.com/vi/${id}/maxresdefault.jpg`;
    thumb.src = t;
    titleEl.textContent = `Video ID: ${id}`;
    subEl.textContent = 'Thumbnail loaded locally. Title fetch via oEmbed may be blocked by CORS; we keep it simple.';
    dot.style.background = 'var(--ok)'; dot.style.boxShadow = '0 0 12px var(--ok)';
  }

  function setBusy(b){
    if(b){
      hint.textContent = 'Contacting your API…';
      dot.style.background = '#ffd166'; dot.style.boxShadow = '0 0 12px #ffd166';
    }else{
      dot.style.background = 'var(--ok)'; dot.style.boxShadow = '0 0 12px var(--ok)';
    }
  }

  async function requestDownload(){
    const api = apiUrlInput.value.trim();
    const u = urlInput.value.trim();
    if(!u){ toastMsg('Paste a URL first'); return; }
    if(!api){ toastMsg('Set your API URL in Settings'); return; }

    setBusy(true); bar.style.width = '10%';
    try{
      const payload = { url: u, format: 'mp4', quality: $('#quality').value, audio: $('#audio').value };
      const res = await fetch(api, {
        method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)
      });
      bar.style.width = '45%';
      if(!res.ok){ throw new Error('Server returned '+res.status); }
      // Expect JSON {downloadUrl:"..."} or a blob
      const ct = res.headers.get('Content-Type')||'';
      if(ct.includes('application/json')){
        const data = await res.json();
        if(data.downloadUrl){ bar.style.width = '80%'; window.location.href = data.downloadUrl; }
        else{ throw new Error('Malformed response'); }
      }else{
        // Assume it's a file stream
        const blob = await res.blob();
        bar.style.width = '80%';
        const a = document.createElement('a');
        const url = URL.createObjectURL(blob);
        a.href = url; a.download = 'video.mp4'; a.click();
        setTimeout(()=>URL.revokeObjectURL(url), 1500);
      }
      bar.style.width = '100%';
      hint.textContent = 'Done. If nothing downloaded, check your API CORS & response headers.';
      setBusy(false);
    }catch(err){
      console.error(err);
      hint.textContent = 'Error: '+ err.message + ' — See console for details.';
      dot.style.background = 'var(--danger)'; dot.style.boxShadow = '0 0 12px var(--danger)';
      bar.style.width = '0%';
      setBusy(false);
    }
  }

  // Events
  $('#previewBtn').addEventListener('click', updatePreview);
  $('#downloadBtn').addEventListener('click', requestDownload);
  $('#openSettings').addEventListener('click', ()=> settings.showModal());
  $('#closeSettings').addEventListener('click', ()=> settings.close());
  $('#saveSettings').addEventListener('click', ()=>{ localStorage.setItem('starlight_api', apiUrlInput.value.trim()); toastMsg('Saved API URL'); settings.close(); });
  $('#clearUrl').addEventListener('click', ()=>{ urlInput.value=''; updatePreview(); });

  // Preview on paste/enter
  urlInput.addEventListener('change', updatePreview);
  urlInput.addEventListener('paste', ()=> setTimeout(updatePreview, 50));
  urlInput.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); updatePreview(); }});

  // Initial
  updatePreview();
</script></body>
</html>